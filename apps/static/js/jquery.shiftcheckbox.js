(function(c){c.fn.shiftcheckbox=function(d){d=c.extend({checkboxSelector:null,selectAll:null,onChange:null,ignoreClick:null},d);"function"!=typeof d.onChange&&(d.onChange=function(c){});c.fn.scb_changeChecked=function(c,d){this.prop("checked",d);c.onChange.call(this,d);return this};var a;d.selectAll&&(a=c(d.selectAll))&&!a.length&&(a=!1);if(a){var b=a.filter(":checkbox").add(a.find(":checkbox"));a=a.not(":checkbox");var h=a.filter(function(){return!c(this).find(b).length});a=a.filter(function(){return!!c(this).find(b).length}).each(function(){c(this).data("childCheckbox",
c(this).find(b)[0])})}if(d.checkboxSelector){var k=this.filter(function(){return!!c(this).find(d.checkboxSelector).filter(":checkbox").length}).each(function(){c(this).data("childCheckbox",c(this).find(d.checkboxSelector).filter(":checkbox")[0])}).add(a);var g=k.map(function(){return c(this).data("childCheckbox")})}else g=this.filter(":checkbox");b&&!b.length?b=!1:g=g.add(b);h&&!h.length&&(h=!1);k&&k.not(a);var e=g.not(b);if(e.length){var m=-1,p=function(a){var l=!!c(this).prop("checked"),f=e.index(this);
if(0>f)b.filter(this).length&&g.scb_changeChecked(d,l);else{if(a.shiftKey&&-1!=m){a=f>m?1:-1;for(var n=m;n!=f;n+=a)e.eq(n).scb_changeChecked(d,l)}b&&(l&&!e.not(":checked").length?b.scb_changeChecked(d,!0):l||b.scb_changeChecked(d,!1));m=f}};if(b)b.prop("checked",!e.not(":checked").length).filter(function(){return!k.find(this).length}).on("click.shiftcheckbox",p);if(h)h.on("click.shiftcheckbox",function(){var c=b?!!b.eq(0).prop("checked"):!!e.eq(0).prop("checked");g.scb_changeChecked(d,!c)});if(d.checkboxSelector)k.on("click.shiftcheckbox",
function(a){if(!c(a.target).closest(d.ignoreClick).length){var b=c(c(this).data("childCheckbox"));b.not(a.target).each(function(){var a=!b.prop("checked");c(this).scb_changeChecked(d,a)});b[0].focus();p.call(b,a);var e=c(a.target).closest("label"),f=e.attr("for");if(f&&f==b.attr("id"))if(e.find(b).length){if(b[0]!=a.target)return!1}else return!1}}).on("mousedown.shiftcheckbox",function(a){if(a.shiftKey)return!1});else e.on("click.shiftcheckbox",p);return this}}})(jQuery);